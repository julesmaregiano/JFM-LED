<div class='container'>
  <div class='text-center'>
    <h1>Créer une réservation</h1>
  </div>
  <%= simple_form_for [:manager, @booking] do |f| %>
    <div class='row'>
      <div class='col-md-6'>
        <%= f.fields_for :address_attributes do |ff| %>
          <%= ff.input :address1, label: "Adresse" %>
        <% end %>
        <%= f.input :product_id, label: "Produit", collection: @products.to_a, label_method: lambda { |product| "#{product.label}" } %>
      </div>
      <div class='col-md-6'>
        <%= f.input :reference,  label: "Numéro d'affaire" %>
        <%= f.input :company_id, label: "Client",           collection: Company.all %>
        <%= f.input :foreman_id, label: "Chef de chantier", collection: Foreman.all %>
        <%= f.input :pdf, label: "Bon de commande", as: :attachinary %>
      </div>
    </div>
    <table class='table'>
      <tbody>
        <% @availabilities.each do |days| %>
          <% days.each_with_index do |day_items, day_item_index| %>
            <tr>
            <% day_items.each_with_index do |item, item_index| %>
               <% if day_item_index.even? && item_index.zero? %>
                <td rowspan='2'><%= item.first_name %></td>
               <% else %>
                 <td>
                   <%= item.class %>
                   <%= f.check_box :availability_ids, name:'booking[availability_ids][]' , value: item.id %>
                 </td>
               <% end %>
            <% end %>
          </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
    <%= react_component 'HelloWorld' %>
    <div class='text-center'>
      <%= f.input :send_confirmation_email, label: "Envoyer mail de confirmation", as: :boolean %>
      <%= f.submit 'Enregistrer la réservation' %>
    </div>
  <% end %>
</div>
